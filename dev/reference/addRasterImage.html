<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add a raster image as a layer — addRasterImage • leaflet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add a raster image as a layer — addRasterImage"><meta name="description" content="Create an image overlay from a RasterLayer or a SpatRaster
object. This is only suitable for small to medium sized rasters,
as the entire image will be embedded into the HTML page (or passed over
the websocket in a Shiny context)."><meta property="og:description" content="Create an image overlay from a RasterLayer or a SpatRaster
object. This is only suitable for small to medium sized rasters,
as the entire image will be embedded into the HTML page (or passed over
the websocket in a Shiny context)."><meta name="robots" content="noindex"><!-- dependencies from examples --><script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet"><script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet"><script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet"><script src="libs/leaflet-binding-2.2.2.9000/leaflet.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">leaflet</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.2.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/leaflet.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/widget.html">The Map Widget</a></li>
    <li><a class="dropdown-item" href="../articles/choropleths.html">Choropleths</a></li>
    <li><a class="dropdown-item" href="../articles/colors.html">Colors</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Customize</h6></li>
    <li><a class="dropdown-item" href="../articles/popups.html">Popups and Labels</a></li>
    <li><a class="dropdown-item" href="../articles/showhide.html">Show/Hide Layers</a></li>
    <li><a class="dropdown-item" href="../articles/markers.html">Add markers to leaflet</a></li>
    <li><a class="dropdown-item" href="../articles/legends.html">Legends</a></li>
    <li><a class="dropdown-item" href="../articles/shapes.html">Lines and Shapes</a></li>
    <li><a class="dropdown-item" href="../articles/basemaps.html">Using Basemaps</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Spatial data</h6></li>
    <li><a class="dropdown-item" href="../articles/json.html">Working with GeoJSON &amp; TopoJSON</a></li>
    <li><a class="dropdown-item" href="../articles/raster.html">Raster Images</a></li>
    <li><a class="dropdown-item" href="../articles/projections.html">Working with projections in Leaflet</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/leaflet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Add a raster image as a layer</h1>
      <small class="dont-index">Source: <a href="https://github.com/rstudio/leaflet/blob/main/R/layers.R" class="external-link"><code>R/layers.R</code></a></small>
      <div class="d-none name"><code>addRasterImage.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create an image overlay from a <code>RasterLayer</code> or a <code>SpatRaster</code>
object. <em>This is only suitable for small to medium sized rasters</em>,
as the entire image will be embedded into the HTML page (or passed over
the websocket in a Shiny context).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">addRasterImage</span><span class="op">(</span></span>
<span>  <span class="va">map</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  colors <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">is.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="st">"Set1"</span> <span class="kw">else</span> <span class="st">"Spectral"</span>,</span>
<span>  opacity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  attribution <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layerId <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  project <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"bilinear"</span>, <span class="st">"ngb"</span><span class="op">)</span>,</span>
<span>  maxBytes <span class="op">=</span> <span class="fl">4</span> <span class="op">*</span> <span class="fl">1024</span> <span class="op">*</span> <span class="fl">1024</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="map-options.html">gridOptions</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="getMapData.html">getMapData</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">projectRasterForLeaflet</span><span class="op">(</span><span class="va">x</span>, <span class="va">method</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-map">map<a class="anchor" aria-label="anchor" href="#arg-map"></a></dt>
<dd><p>a map widget object</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">terra::SpatRaster()</a></code> or a <code>RasterLayer</code> object–see <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster::raster()</a></code></p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>the color palette (see <code><a href="colorNumeric.html">colorNumeric()</a></code>) or function
to use to color the raster values (hint: if providing a function, set
<code>na.color</code> to <code>"#00000000"</code> to make <code>NA</code> areas transparent).
The palette is ignored if <code>x</code> is a SpatRaster with a color table or if
it has RGB channels.</p></dd>


<dt id="arg-opacity">opacity<a class="anchor" aria-label="anchor" href="#arg-opacity"></a></dt>
<dd><p>the base opacity of the raster, expressed from 0 to 1</p></dd>


<dt id="arg-attribution">attribution<a class="anchor" aria-label="anchor" href="#arg-attribution"></a></dt>
<dd><p>the HTML string to show as the attribution for this layer</p></dd>


<dt id="arg-layerid">layerId<a class="anchor" aria-label="anchor" href="#arg-layerid"></a></dt>
<dd><p>the layer id</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>the name of the group this raster image should belong to (see
the same parameter under <code><a href="map-layers.html">addTiles()</a></code>)</p></dd>


<dt id="arg-project">project<a class="anchor" aria-label="anchor" href="#arg-project"></a></dt>
<dd><p>if <code>TRUE</code>, automatically project <code>x</code> to the map
projection expected by Leaflet (<code>EPSG:3857</code>); if <code>FALSE</code>, it's
the caller's responsibility to ensure that <code>x</code> is already projected,
and that <code>extent(x)</code> is expressed in WGS84 latitude/longitude
coordinates</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>the method used for computing values of the new, projected raster image.
<code>"bilinear"</code> (the default) is appropriate for continuous data,
<code>"ngb"</code> - nearest neighbor - is appropriate for categorical data.
Ignored if <code>project = FALSE</code>. See <code><a href="https://rdrr.io/pkg/raster/man/projectRaster.html" class="external-link">projectRaster()</a></code> for details.</p></dd>


<dt id="arg-maxbytes">maxBytes<a class="anchor" aria-label="anchor" href="#arg-maxbytes"></a></dt>
<dd><p>the maximum number of bytes to allow for the projected image
(before base64 encoding); defaults to 4MB.</p></dd>


<dt id="arg-options">options<a class="anchor" aria-label="anchor" href="#arg-options"></a></dt>
<dd><p>a list of additional options, intended to be provided by
a call to <code><a href="map-options.html">gridOptions()</a></code></p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>the data object from which the argument values are derived; by
default, it is the <code>data</code> object provided to <code><a href="leaflet.html">leaflet()</a></code>
initially, but can be overridden</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>maxBytes</code> parameter serves to prevent you from accidentally
embedding an excessively large amount of data into your htmlwidget. This
value is compared to the size of the final compressed image (after the raster
has been projected, colored, and PNG encoded, but before base64 encoding is
applied). Set <code>maxBytes</code> to <code>Inf</code> to disable this check, but be
aware that very large rasters may not only make your map a large download but
also may cause the browser to become slow or unresponsive.</p>
<p>To reduce the size of a SpatRaster, you can use <code><a href="https://rspatial.github.io/terra/reference/sample.html" class="external-link">terra::spatSample()</a></code>
as in <code>x = spatSample(x, 100000, method="regular", as.raster=TRUE)</code>. With
a <code>RasterLayer</code> you can use <code><a href="https://rdrr.io/pkg/raster/man/sampleRegular.html" class="external-link">raster::sampleRegular()</a></code> as in
<code>sampleRegular(x, 100000, asRaster=TRUE)</code>.</p>
<p>By default, <code>addRasterImage()</code> will project the raster data
<code>x</code> to the Pseudo-Mercator projection (EPSG:3857). This can be a
time-consuming operation for even moderately sized rasters; although it is much
faster for SpatRasters than for RasterLayers.
If you are repeatedly adding a particular raster to your Leaflet
maps, you can perform the projection ahead of time using
<code>projectRasterForLeaflet()</code>, and call <code>addRasterImage()</code> with
<code>project = FALSE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="addRasterLegend.html">addRasterLegend()</a></code> for an easy way to add a legend for a
SpatRaster with a color table.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: sp</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span>xmn <span class="op">=</span> <span class="op">-</span><span class="fl">2.8</span>, xmx <span class="op">=</span> <span class="op">-</span><span class="fl">2.79</span>, ymn <span class="op">=</span> <span class="fl">54.04</span>, ymx <span class="op">=</span> <span class="fl">54.05</span>, nrows <span class="op">=</span> <span class="fl">30</span>, ncols <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">900</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/CRS-class.html" class="external-link">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:4326"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>GDAL Message 1: +init=epsg:XXXX syntax is deprecated. It might return a CRS with a non-EPSG compliant axis order.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="colorNumeric.html">colorNumeric</a></span><span class="op">(</span><span class="st">"Spectral"</span>, domain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="leaflet.html">leaflet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="map-layers.html">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">addRasterImage</span><span class="op">(</span><span class="va">r</span>, colors <span class="op">=</span> <span class="va">pal</span>, opacity <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="addLegend.html">addLegend</a></span><span class="op">(</span>pal <span class="op">=</span> <span class="va">pal</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span></span>
<div id="htmlwidget-21c7483268bafca56cec" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-21c7483268bafca56cec">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addRasterImage","args":["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAACJUlEQVRIiZ1V227bMAw9bNh1Ltrau7zsd/qj/cBtCQpkgAMs5R6sC0VStrOXyiLPTbSc0tvdq4AAIgBEaUVnXfpEABD0oPapXzDLn4Lh6QcrkYXshBGTyWGo6TUYUKPL08StUQJEAta85cUG6VHVlgf+MnLHJE6PxkRcfRsni/HTKAHBC5IV3mUaaadRDy9XBwqNUr/UDQaQIFx+FqfLw8vfyrXiZgrx6TynXoL63vM+P/PDlJPY70Cb6NtMrl4M1b2oWj4MQODD9yEQtESqp+oJBqF6U1iMvw1hg3ohgrHZAD6g5/Pd10ElNemDtXlnO/DxNwkwTc83EW416OEZ41NAWCNGuNuDMcbndWJkYvs9fKpTUGd6HPuCPbG1EDvDMR5H09gQ+x9TxycwhulG0h6cQNKal1zJBb7ef6qATJFMyvAPI5j6H2gNbL/RawPx5Xp2FIhJ3PRVRzYMnV7t85yMGwHZMCwjjAx14KznA/F8/ZM1AFCl1NdTeOn/k9rD4Ft+gwdBpO75dOEiUoxEE6IQ1OBdCFAnWK3xaWZjqge3hFg3qUG2pqX7fLwcDKCOLBaIQ7r+BpZ/z9QHdIS9ODkjjXVcAfjXbC/EPuPVXmBke/xz3icchQpPn2+z1DryZS1gAh/PB/WZUQLWS7NGLkaJC22e8FpL/d6Az6fPhqACdEylCVRPWCdlD+Ax/H58aMesiNrIYaTe/HKivC+4GlCUjgjwD8Ffj6cl3305AAAAAElFTkSuQmCC",[[54.04999999999998,-2.799999999999999],[54.03999999999998,-2.79]],null,null,{"tileSize":256,"zIndex":1,"minZoom":0,"opacity":0.8}]},{"method":"addLegend","args":[{"colors":["#9E0142 , #9E0142 0%, #F46D43 20%, #FEE08B 40%, #E6F598 60%, #66C2A5 80%, #5E4FA2 100%, #5E4FA2 "],"labels":["0","200","400","600","800","1,000"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"numeric","title":null,"extra":{"p_1":0,"p_n":1},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[54.03999999999998,54.04999999999998],"lng":[-2.799999999999999,-2.79]}},"evals":[],"jsHooks":[]}</script><span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Joe Cheng, <a href="http://schloerke.com" class="external-link">Barret Schloerke</a>, Bhaskar Karambelkar, <a href="https://yihui.org/" class="external-link">Yihui Xie</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>. The Leaflet JavaScript library is © 2010–2023 <a href="http://agafonkin.com/en" class="external-link">Vladimir Agafonkin</a>, 2010–2011 <a href="http://cloudmade.com/" class="external-link">CloudMade</a>. Maps © <a href="https://openstreetmap.org/copyright" class="external-link">OpenStreetMap</a> contributors unless otherwise noted.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

  </div></footer></body></html>

